<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>rootdeng的博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="rootdeng的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="rootdeng的博客">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rootdeng的博客">
  
    <link rel="alternative" href="/atom.xml" title="rootdeng的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1539877444364&amp;di=194ef2ced171f80307eb7c974f561646&amp;imgtype=0&amp;src=http%3A%2F%2Fimgm.gmw.cn%2Fattachement%2Fjpg%2Fsite2%2F20180922%2F125902468397287372.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">#include&lt;deng&gt;</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/rootdeng77/rootdeng77.github.io" title="github">github</a>
					        
								<a class="mail" target="_blank" href="/438524651@qq.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/MapReduce/" style="font-size: 10px;">MapReduce</a> <a href="/tags/Mapreduce/" style="font-size: 10px;">Mapreduce</a> <a href="/tags/Mybatis/" style="font-size: 16.67px;">Mybatis</a> <a href="/tags/PTA/" style="font-size: 13.33px;">PTA</a> <a href="/tags/Spring/" style="font-size: 20px;">Spring</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/poj/" style="font-size: 13.33px;">poj</a> <a href="/tags/后端/" style="font-size: 16.67px;">后端</a> <a href="/tags/图论/" style="font-size: 10px;">图论</a> <a href="/tags/堆/" style="font-size: 10px;">堆</a> <a href="/tags/字符串/" style="font-size: 10px;">字符串</a> <a href="/tags/广度优先搜索/" style="font-size: 10px;">广度优先搜索</a> <a href="/tags/数据挖掘/" style="font-size: 13.33px;">数据挖掘</a> <a href="/tags/最小区间覆盖/" style="font-size: 10px;">最小区间覆盖</a> <a href="/tags/最短路问题/" style="font-size: 10px;">最短路问题</a> <a href="/tags/深度优先搜索/" style="font-size: 10px;">深度优先搜索</a> <a href="/tags/计算几何/" style="font-size: 10px;">计算几何</a> <a href="/tags/贪心算法/" style="font-size: 10px;">贪心算法</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://xuhacker.me/">佳叙的博客</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">#include&lt;deng&gt;</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1539877444364&amp;di=194ef2ced171f80307eb7c974f561646&amp;imgtype=0&amp;src=http%3A%2F%2Fimgm.gmw.cn%2Fattachement%2Fjpg%2Fsite2%2F20180922%2F125902468397287372.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">#include&lt;deng&gt;</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/rootdeng77/rootdeng77.github.io" title="github">github</a>
			        
						<a class="mail" target="_blank" href="/438524651@qq.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="[layout]-Spring事务管理" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/Spring事务管理/" class="article-date">
  	<time datetime="2019-03-31T14:32:14.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/Spring事务管理/">
        Spring事务管理
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿</p>
<h1 id="Spring事务管理"><a href="#Spring事务管理" class="headerlink" title="Spring事务管理"></a>Spring事务管理</h1><p> 这篇主要是介绍spring的事务管理部分，主要是基于XML方式的声明式事务和基于Annotation的声明式事务</p>
<h2 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h2><p>在目前阶段，所使用的开发环境主要如下<br>IDEA2018.2.5<br>Spring-5.1.4</p>
<h2 id="使用前配置"><a href="#使用前配置" class="headerlink" title="使用前配置"></a>使用前配置</h2><p>所需要的jar文件<br><img src="https://img-blog.csdnimg.cn/2019032211302441.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="所需要的jar文件"></p>
<h4 id="在这里直接采用上一篇博客中写好的类及其方法"><a href="#在这里直接采用上一篇博客中写好的类及其方法" class="headerlink" title="在这里直接采用上一篇博客中写好的类及其方法"></a>在这里直接采用上一篇博客中写好的类及其方法</h4><p>链接如下<br><a href="https://blog.csdn.net/zhangdy12307/article/details/88698616" target="_blank" rel="noopener">Account类及其方法和属性</a></p>
<h2 id="基于XML方式的声明式事务"><a href="#基于XML方式的声明式事务" class="headerlink" title="基于XML方式的声明式事务"></a>基于XML方式的声明式事务</h2><p>xml文件如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line">    http://www.springframework.org/schema/beans/spring-beans-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx</span><br><span class="line">    http://www.springframework.org/schema/tx/spring-tx-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/context</span><br><span class="line">    http://www.springframework.org/schema/context/spring-context-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop</span><br><span class="line">    http://www.springframework.org/schema/aop/spring-aop-4.3.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- 1.配置数据源 --&gt;</span><br><span class="line">    &lt;bean id=&quot;dataSource&quot;</span><br><span class="line">          class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;</span><br><span class="line">        &lt;!--数据库驱动 --&gt;</span><br><span class="line">        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的url --&gt;</span><br><span class="line">        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost/spring&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的用户名 --&gt;</span><br><span class="line">        &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的密码 --&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 2.配置JDBC模板 --&gt;</span><br><span class="line">    &lt;bean id=&quot;jdbcTemplate&quot;</span><br><span class="line">          class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt;</span><br><span class="line">        &lt;!-- 默认必须使用数据源 --&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!--3.定义id为accountDao的Bean --&gt;</span><br><span class="line">    &lt;bean id=&quot;accountDao&quot; class=&quot;com.jdbc.AccountDaoImpl&quot;&gt;</span><br><span class="line">        &lt;!-- 将jdbcTemplate注入到AccountDao实例中 --&gt;</span><br><span class="line">        &lt;property name=&quot;jdbcTemplate&quot; ref=&quot;jdbcTemplate&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 4.事务管理器，依赖于数据源 --&gt;</span><br><span class="line">    &lt;bean id=&quot;transactionManager&quot; class=</span><br><span class="line">            &quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 5.编写通知：对事务进行增强(通知),需要编写对切入点和具体执行事务细节 --&gt;</span><br><span class="line">    &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;</span><br><span class="line">        &lt;tx:attributes&gt;</span><br><span class="line">            &lt;!-- name：*表示任意方法名称 --&gt;</span><br><span class="line">            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;</span><br><span class="line">                       isolation=&quot;DEFAULT&quot; read-only=&quot;false&quot; /&gt;</span><br><span class="line">        &lt;/tx:attributes&gt;</span><br><span class="line">    &lt;/tx:advice&gt;</span><br><span class="line">    &lt;!-- 6.编写aop，让spring自动对目标生成代理，需要使用AspectJ的表达式 --&gt;</span><br><span class="line">    &lt;aop:config&gt;</span><br><span class="line">        &lt;!-- 切入点 --&gt;</span><br><span class="line">        &lt;aop:pointcut expression=&quot;execution(* com.jdbc.*.*(..))&quot;</span><br><span class="line">                      id=&quot;txPointCut&quot; /&gt;</span><br><span class="line">        &lt;!-- 切面：将切入点与通知整合 --&gt;</span><br><span class="line">        &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;txPointCut&quot; /&gt;</span><br><span class="line">    &lt;/aop:config&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></p>
<h5 id="在AccountDao接口中创建transfer-方法"><a href="#在AccountDao接口中创建transfer-方法" class="headerlink" title="在AccountDao接口中创建transfer()方法"></a>在AccountDao接口中创建transfer()方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void transfer(String outUser,String inUser,Double money);</span><br></pre></td></tr></table></figure>
<h5 id="在AccountDaoImpl中实现transfer-方法"><a href="#在AccountDaoImpl中实现transfer-方法" class="headerlink" title="在AccountDaoImpl中实现transfer()方法"></a>在AccountDaoImpl中实现transfer()方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public void transfer(String outUser,String inUser,Double money)&#123;</span><br><span class="line">        this.jdbcTemplate.update(&quot;update account set balance = balance +?&quot;+&quot;where username = ?&quot;,money,inUser);</span><br><span class="line">        int i=1/0;  //用来模拟系统运行时突发性的问题，</span><br><span class="line">//  如果没有事务控制，在转账操作执行后，收款用户余额会增加</span><br><span class="line"> //  而汇款用户的余额因为系统问题保持不变</span><br><span class="line"> //  增加事务控制后，在转账操作执行后，收款和汇款用户的余额在出现问题前后都保持不变</span><br><span class="line">        this.jdbcTemplate.update(&quot;update account set balance = balance -?&quot;+&quot;where username = ?&quot;,money,outUser);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h5 id="编写测试类方法"><a href="#编写测试类方法" class="headerlink" title="编写测试类方法"></a>编写测试类方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void xmlTest()&#123;</span><br><span class="line">        ApplicationContext applicationContext= new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span><br><span class="line">        AccountDao accountDao=(AccountDao) applicationContext.getBean(&quot;accountDao&quot;);</span><br><span class="line">        accountDao.transfer(&quot;jack&quot;,&quot;Rose&quot;,100.0);</span><br><span class="line">        System.out.println(&quot;转账成功&quot;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h5 id="运行如下"><a href="#运行如下" class="headerlink" title="运行如下"></a>运行如下</h5><p><img src="https://img-blog.csdnimg.cn/20190322124237898.png" alt="在这里插入图片描述"></p>
<h2 id="基于Annotation方式的声明式事务"><a href="#基于Annotation方式的声明式事务" class="headerlink" title="基于Annotation方式的声明式事务"></a>基于Annotation方式的声明式事务</h2><p>xml文件如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line">    http://www.springframework.org/schema/beans/spring-beans-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx</span><br><span class="line">    http://www.springframework.org/schema/tx/spring-tx-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/context</span><br><span class="line">    http://www.springframework.org/schema/context/spring-context-4.3.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop</span><br><span class="line">    http://www.springframework.org/schema/aop/spring-aop-4.3.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- 1.配置数据源 --&gt;</span><br><span class="line">    &lt;bean id=&quot;dataSource&quot;</span><br><span class="line">          class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;</span><br><span class="line">        &lt;!--数据库驱动 --&gt;</span><br><span class="line">        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的url --&gt;</span><br><span class="line">        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost/spring&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的用户名 --&gt;</span><br><span class="line">        &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">        &lt;!--连接数据库的密码 --&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 2.配置JDBC模板 --&gt;</span><br><span class="line">    &lt;bean id=&quot;jdbcTemplate&quot;</span><br><span class="line">          class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt;</span><br><span class="line">        &lt;!-- 默认必须使用数据源 --&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!--3.定义id为accountDao的Bean --&gt;</span><br><span class="line">    &lt;bean id=&quot;accountDao&quot; class=&quot;com.jdbc.AccountDaoImpl&quot;&gt;</span><br><span class="line">        &lt;!-- 将jdbcTemplate注入到AccountDao实例中 --&gt;</span><br><span class="line">        &lt;property name=&quot;jdbcTemplate&quot; ref=&quot;jdbcTemplate&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 4.事务管理器，依赖于数据源 --&gt;</span><br><span class="line">    &lt;bean id=&quot;transactionManager&quot; class=</span><br><span class="line">            &quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- 5.编写通知：对事务进行增强(通知),需要编写对切入点和具体执行事务细节 --&gt;</span><br><span class="line">    &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></p>
<h5 id="修改AccountDaoImpl中实现transfer-方法"><a href="#修改AccountDaoImpl中实现transfer-方法" class="headerlink" title="修改AccountDaoImpl中实现transfer()方法"></a>修改AccountDaoImpl中实现transfer()方法</h5><p>在这个过程中，只需添加事务注解便可，代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Transactional(propagation = Propagation.REQUIRED,</span><br><span class="line">           isolation = Isolation.DEFAULT,readOnly = false)</span><br><span class="line">   public void transfer(String outUser,String inUser,Double money)&#123;</span><br><span class="line">       this.jdbcTemplate.update(&quot;update account set balance = balance +?&quot;+&quot;where username = ?&quot;,money,inUser);</span><br><span class="line">    //   int i=1/0;</span><br><span class="line">       this.jdbcTemplate.update(&quot;update account set balance = balance -?&quot;+&quot;where username = ?&quot;,money,outUser);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="运行，提示转账成功"><a href="#运行，提示转账成功" class="headerlink" title="运行，提示转账成功"></a>运行，提示转账成功</h5><h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>通过对比这两种事务处理方式，发现基于Annotation方式的事务注解只需要做两件事，其一在Spring容器中注册事务注解驱动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;</span><br></pre></td></tr></table></figure></p>
<p>其二在需要使用事务的Bean类方法前添加注解@Transactional</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-Python数据挖掘入门与实践-亲和性分析" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/Python数据挖掘入门与实践-亲和性分析/" class="article-date">
  	<time datetime="2019-03-31T14:31:28.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/Python数据挖掘入门与实践-亲和性分析/">
        Python数据挖掘入门与实践--亲和性分析
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# Python数据挖掘入门与实践–亲和性分析</p>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>这段时间时间找了好多关于数据挖掘方向的数据，不过这些书籍大都偏向理论，看起来也比较枯燥乏味，碰巧今天找到了这本《Python数据挖掘入门与实践》，入门级别，刚好适合我这种爱代码不爱理论的人，从今天开始正式学习数据挖掘。<br>博客中展示的大部分代码都是按照书中的内容编写出来，有些地方会按照自己的思路有一小部分的改动</p>
<h3 id="亲和性分析定义"><a href="#亲和性分析定义" class="headerlink" title="亲和性分析定义"></a>亲和性分析定义</h3><p>亲和性分析根据样本个体（物体）之间的相似度，确定他它们关系的亲疏</p>
<h3 id="亲和性分析之商品推荐"><a href="#亲和性分析之商品推荐" class="headerlink" title="亲和性分析之商品推荐"></a>亲和性分析之商品推荐</h3><p>这部分内容是通过超市的商品服务的数据集，使得通过商品推荐例子希望得到如下规则：<br>如果一个人购买了商品X，那么他很有可能购买商品Y</p>
<h4 id="1、在Numpy中加载数据集"><a href="#1、在Numpy中加载数据集" class="headerlink" title="1、在Numpy中加载数据集"></a>1、在Numpy中加载数据集</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">dataset_filename=&quot;affinity_dataset.txt&quot;</span><br><span class="line">X=np.loadtxt(dataset_filename)</span><br></pre></td></tr></table></figure>
<p>加载完成后我们可以用如下代码查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(X[:5])</span><br></pre></td></tr></table></figure></p>
<p>运行结果如下，图中1表示顾客购买了该商品，0表示未购买该商品<br><img src="https://img-blog.csdnimg.cn/20190327154812851.png" alt="加载后的结果如下"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n_samples,n_features=X.shape     # 记录数据范围</span><br><span class="line">features=[&quot;bread&quot;,&quot;milk&quot;,&quot;cheese&quot;,&quot;apples&quot;,&quot;bananas&quot;] </span><br><span class="line">#features 表示的是每列数据表示的商品</span><br></pre></td></tr></table></figure></p>
<h4 id="2、实现简单的排序规则"><a href="#2、实现简单的排序规则" class="headerlink" title="2、实现简单的排序规则"></a>2、实现简单的排序规则</h4><p>首先我们需要了解两个基本概念<br><strong>支持度</strong>：指数据集中规则应验的次数。<br><strong>置信度</strong>：衡量规则的准确率。<br>规则的优劣有多种衡量方法，常用的是支持度和置信度<br>如下的代码是展示如何求“如果顾客购买了苹果，他们也会国脉香蕉” 的支持度和可信度<br>数据中第三列表示是否购买苹果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">num_apple_purchases=0</span><br><span class="line">for sample in X:</span><br><span class="line">    if sample[3]==1:</span><br><span class="line">        num_apple_purchases+=1</span><br><span class="line">print(&quot;&#123;0&#125; people bought Apples&quot;.format(num_apple_purchases))</span><br></pre></td></tr></table></figure></p>
<p>运行结果显示26人购买苹果</p>
<h6 id="接下来的代码展示计算所有规则的置信度"><a href="#接下来的代码展示计算所有规则的置信度" class="headerlink" title="接下来的代码展示计算所有规则的置信度"></a>接下来的代码展示计算所有规则的置信度</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from collections import defaultdict</span><br><span class="line">valid_rules=defaultdict(int)</span><br><span class="line">invalid_rules=defaultdict(int)</span><br><span class="line">num_occurances=defaultdict(int)</span><br><span class="line"># 计算过程使用循环结构对样本的每个特征值进行处理</span><br><span class="line">for sample in X:</span><br><span class="line">    for premise in range(n_features):</span><br><span class="line">        if sample[premise]==0:    #判断是否满足条件</span><br><span class="line">            continue</span><br><span class="line">        num_occurances[premise]+=1</span><br><span class="line">        for conclusion in range(n_features):  #如果对应的规则应验，键为条件，规则的的元组加一</span><br><span class="line">        #反之违反规则加一</span><br><span class="line">            if premise==conclusion:</span><br><span class="line">                continue</span><br><span class="line">            if sample[conclusion]==1:</span><br><span class="line">                valid_rules[(premise,conclusion)]+=1</span><br><span class="line">            else:</span><br><span class="line">                invalid_rules[(premise,conclusion)]+=1</span><br><span class="line">support=valid_rules</span><br><span class="line">confidence=defaultdict(float)</span><br><span class="line">#计算每个规则对应的置信度</span><br><span class="line">for premise,conclusion in valid_rules.keys():</span><br><span class="line">    rule=(premise,conclusion)</span><br><span class="line">    confidence[rule]=valid_rules[rule]/num_occurances[premise]</span><br></pre></td></tr></table></figure>
<p>这样我们便得到了每个规则所对应的置信度和支持度<br>打印每个规则所对应的置信度和支持度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def print_rule(premise,conclusion,support,confidence,features):</span><br><span class="line">    premise_name=features[premise]</span><br><span class="line">    conclusion_name=features[conclusion]</span><br><span class="line">    print(&quot;Rule: If a person buys &#123;0&#125; they will also buy&#123;1&#125;&quot;.format(premise_name,conclusion_name))</span><br><span class="line">    print(&quot; - Support: &#123;0&#125;&quot;.format(support[(premise,conclusion)]))</span><br><span class="line">    print(&quot; - Confidence: &#123;0:.3f&#125;&quot;.format(confidence[(premise,conclusion)]))</span><br></pre></td></tr></table></figure></p>
<p>现在显示如果一个顾客购买苹果，那么他很有可能购买香蕉的置信度和支持度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">premise=1</span><br><span class="line">conclusion=3</span><br><span class="line">print_rule(premise,conclusion,support,confidence,features)</span><br></pre></td></tr></table></figure></p>
<p>结果如下<br><img src="https://img-blog.csdnimg.cn/20190327162717302.png" alt="在这里插入图片描述"></p>
<h4 id="3、找出最佳的排序规则"><a href="#3、找出最佳的排序规则" class="headerlink" title="3、找出最佳的排序规则"></a>3、找出最佳的排序规则</h4><p>为了找到支持度最高的规则，首先对支持度字典进行排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from operator import itemgetter</span><br><span class="line">sorted_support=sorted(support.items(),key=itemgetter(1),reverse=True)</span><br><span class="line">#按照支持度降序排序</span><br></pre></td></tr></table></figure></p>
<p>输出支持度最高的前五条规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for index in range(5):</span><br><span class="line">    print(&quot;Rule #&#123;0&#125;&quot;.format(index+1))</span><br><span class="line">    premise,conclusion=sorted_support[index][0]</span><br><span class="line">    print_rule(premise,conclusion,support,confidence,features)</span><br></pre></td></tr></table></figure></p>
<p>结果如下<br><img src="https://img-blog.csdnimg.cn/20190327163339629.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>同理，查找置信度最高的前五条规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sorted_confidence=sorted(confidence.items(),key=itemgetter(1),reverse=True)</span><br><span class="line">for index in range(5):</span><br><span class="line">    print(&quot;Rule #&#123;0&#125;&quot;.format(index+1))</span><br><span class="line">    premise,conclusion=sorted_confidence[index][0]</span><br><span class="line">    print_rule(premise,conclusion,support,confidence,features)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdnimg.cn/20190327163603751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h6 id="如果我是超市的老板的话，那么我肯定会按照以上规则对商品进行排序"><a href="#如果我是超市的老板的话，那么我肯定会按照以上规则对商品进行排序" class="headerlink" title="如果我是超市的老板的话，那么我肯定会按照以上规则对商品进行排序"></a>如果我是超市的老板的话，那么我肯定会按照以上规则对商品进行排序</h6><h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>由于不经常用python语言，导致有时对代码的理解比较困难，也没有见过python那么多的奇技淫巧，呜呼哀哉，好好学习吧</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据挖掘/">数据挖掘</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-csdn-export-md" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/csdn-export-md/" class="article-date">
  	<time datetime="2019-03-31T14:31:05.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/csdn-export-md/">
        MyBatis的关系映射——多对多
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# MyBatis的关系映射——多对多</p>
<h2 id="多对多的关系"><a href="#多对多的关系" class="headerlink" title="多对多的关系"></a>多对多的关系</h2><p>在A类中定义B类类型的集合，在B类中定义A类类型的集合</p>
<h6 id="这次的博客直接在上一篇MyBatis的关系映射——一对多的基础上写，直接添加相关文件就可以"><a href="#这次的博客直接在上一篇MyBatis的关系映射——一对多的基础上写，直接添加相关文件就可以" class="headerlink" title="这次的博客直接在上一篇MyBatis的关系映射——一对多的基础上写，直接添加相关文件就可以"></a>这次的博客直接在上一篇<a href="https://blog.csdn.net/zhangdy12307/article/details/88932470" target="_blank" rel="noopener">MyBatis的关系映射——一对多</a>的基础上写，直接添加相关文件就可以</h6><h3 id="1、创建相关数据库"><a href="#1、创建相关数据库" class="headerlink" title="1、创建相关数据库"></a>1、创建相关数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">create table tb_product(</span><br><span class="line">id int(32) primary key auto_increment,</span><br><span class="line">name varchar(32),</span><br><span class="line">price double</span><br><span class="line">);</span><br><span class="line">insert into tb_product values (&apos;1&apos;,&apos;Java fundment&apos;,&apos;44.5&apos;);</span><br><span class="line">insert into tb_product values (&apos;2&apos;,&apos;Java Web fundment&apos;,&apos;38.5&apos;);</span><br><span class="line">insert into tb_product values (&apos;3&apos;,&apos;SSM prictence&apos;,&apos;50&apos;);</span><br><span class="line">create table tb_ordersitem(</span><br><span class="line">id int(32) primary key auto_increment,</span><br><span class="line">orders_id int(32),</span><br><span class="line">product_id int(32),</span><br><span class="line">foreign key(orders_id) references tb_orders(id),</span><br><span class="line">foreign key(product_id) references tb_product(id)</span><br><span class="line">);</span><br><span class="line">insert into tb_ordersitem values (&apos;1&apos;,&apos;1&apos;,&apos;1&apos;);</span><br><span class="line">insert into tb_ordersitem values (&apos;2&apos;,&apos;1&apos;,&apos;3&apos;);</span><br><span class="line">insert into tb_ordersitem values (&apos;3&apos;,&apos;3&apos;,&apos;3&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="2、在com-po包中创建类Product并重写Orders类"><a href="#2、在com-po包中创建类Product并重写Orders类" class="headerlink" title="2、在com.po包中创建类Product并重写Orders类"></a>2、在com.po包中创建类Product并重写Orders类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class Product &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String username;</span><br><span class="line">    private Double price;</span><br><span class="line">    private List&lt;Orders&gt; orders;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Double getPrice() &#123;</span><br><span class="line">        return price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPrice(Double price) &#123;</span><br><span class="line">        this.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public List&lt;Orders&gt; getOrders() &#123;</span><br><span class="line">        return orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setOrders(List&lt;Orders&gt; orders) &#123;</span><br><span class="line">        this.orders = orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Product&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, price=&quot; + price +</span><br><span class="line">                &quot;, orders=&quot; + orders +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重写Orders类的主要目的是为了方便查看数据结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class Orders &#123;</span><br><span class="line">    private Integer id;    </span><br><span class="line">    private String number;</span><br><span class="line">    private List&lt;Product&gt; productList;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getNumber() &#123;</span><br><span class="line">        return number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setNumber(String number) &#123;</span><br><span class="line">        this.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public List&lt;Product&gt; getProductList() &#123;</span><br><span class="line">        return productList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setProductList(List&lt;Product&gt; productList) &#123;</span><br><span class="line">        this.productList = productList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Orders&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, number=&apos;&quot; + number + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, productList=&quot; + productList +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="3、在com-mapper中创建实体映射文件OrdersMapper-xml和商品实体映射文件ProductMapper-xml"><a href="#3、在com-mapper中创建实体映射文件OrdersMapper-xml和商品实体映射文件ProductMapper-xml" class="headerlink" title="3、在com.mapper中创建实体映射文件OrdersMapper.xml和商品实体映射文件ProductMapper.xml"></a>3、在com.mapper中创建实体映射文件OrdersMapper.xml和商品实体映射文件ProductMapper.xml</h3><h6 id="OrdersMapper-xml如下所示"><a href="#OrdersMapper-xml如下所示" class="headerlink" title="OrdersMapper.xml如下所示"></a>OrdersMapper.xml如下所示</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; </span><br><span class="line">     &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.OrdersMapper&quot;&gt;</span><br><span class="line">	&lt;!-- 多对多嵌套查询：通过执行另外一条SQL映射语句来返回预期的特殊类型 --&gt;</span><br><span class="line">	&lt;select id=&quot;findOrdersWithProduct&quot; parameterType=&quot;Integer&quot;</span><br><span class="line">              resultMap=&quot;OrdersWithProductResult&quot;&gt;</span><br><span class="line">		select * from tb_orders WHERE id=#&#123;id&#125;	</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Orders&quot; id=&quot;OrdersWithProductResult&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;number&quot; column=&quot;number&quot; /&gt;</span><br><span class="line">		&lt;collection property=&quot;productList&quot; column=&quot;id&quot; ofType=&quot;Product&quot; </span><br><span class="line">		     select=&quot;com.mapper.ProductMapper.findProductById&quot;&gt;</span><br><span class="line">		&lt;/collection&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 多对多嵌套结果查询：查询某订单及其关联的商品详情 --&gt;</span><br><span class="line">	&lt;select id=&quot;findOrdersWithPorduct2&quot; parameterType=&quot;Integer&quot; </span><br><span class="line">	         resultMap=&quot;OrdersWithPorductResult2&quot;&gt;</span><br><span class="line">	    select o.*,p.id as pid,p.name,p.price</span><br><span class="line">	    from tb_orders o,tb_product p,tb_ordersitem  oi</span><br><span class="line">	    WHERE oi.orders_id=o.id </span><br><span class="line">	    and oi.product_id=p.id </span><br><span class="line">	    and o.id=#&#123;id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;!-- 自定义手动映射类型 --&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Orders&quot; id=&quot;OrdersWithPorductResult2&quot;&gt;</span><br><span class="line">	    &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line">	    &lt;result property=&quot;number&quot; column=&quot;number&quot; /&gt;</span><br><span class="line">	    &lt;!-- 多对多关联映射：collection --&gt;</span><br><span class="line">	    &lt;collection property=&quot;productList&quot; ofType=&quot;Product&quot;&gt;</span><br><span class="line">	        &lt;id property=&quot;id&quot; column=&quot;pid&quot; /&gt;</span><br><span class="line">	        &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;</span><br><span class="line">	        &lt;result property=&quot;price&quot; column=&quot;price&quot; /&gt;</span><br><span class="line">	    &lt;/collection&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h6 id="ProductMapper-xml如下所示"><a href="#ProductMapper-xml如下所示" class="headerlink" title="ProductMapper.xml如下所示"></a>ProductMapper.xml如下所示</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">     &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.ProductMapper&quot;&gt;</span><br><span class="line">	&lt;select id=&quot;findProductById&quot; parameterType=&quot;Integer&quot; </span><br><span class="line">                                       resultType=&quot;Product&quot;&gt;</span><br><span class="line">		SELECT * from tb_product where id IN(</span><br><span class="line">		   SELECT product_id FROM tb_ordersitem  WHERE orders_id = #&#123;id&#125;</span><br><span class="line">		)</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4、将新创建的映射文件的文件路径添加到配置文件Mybatis-config-xml中"><a href="#4、将新创建的映射文件的文件路径添加到配置文件Mybatis-config-xml中" class="headerlink" title="4、将新创建的映射文件的文件路径添加到配置文件Mybatis-config.xml中"></a>4、将新创建的映射文件的文件路径添加到配置文件Mybatis-config.xml中</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;mapper resource=&quot;com/mapper/OrdersMapper.xml&quot; /&gt;</span><br><span class="line">&lt;mapper resource=&quot;com/mapper/ProductMapper.xml&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h4 id="5、在测试类中编写多对多关联查询的测试方法findOrdersTest"><a href="#5、在测试类中编写多对多关联查询的测试方法findOrdersTest" class="headerlink" title="5、在测试类中编写多对多关联查询的测试方法findOrdersTest()"></a>5、在测试类中编写多对多关联查询的测试方法findOrdersTest()</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void findOrdersTest()&#123;</span><br><span class="line">    SqlSession session=MybatisUtils.getSession();</span><br><span class="line">    Orders orders=session.selectOne(&quot;com.mapper.&quot;+&quot;OrdersMapper.findOrdersWithProduct&quot;,1);</span><br><span class="line">    System.out.println(orders);</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果如下<br><img src="https://img-blog.csdnimg.cn/20190331180806264.png" alt="在这里插入图片描述"></p>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>在这次过程中遇到如下问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">org.apache.ibatis.exceptions.PersistenceException: </span><br><span class="line">### Error querying database.  Cause: java.lang.IllegalArgumentException: Mapped Statements collection does not contain value for com.mapper.OrdersMapper.findOrdersWithProduct</span><br><span class="line">### Cause: java.lang.IllegalArgumentException: Mapped Statements collection does not contain value for com.mapper.OrdersMapper.findOrdersWithProduct</span><br><span class="line"></span><br><span class="line">	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)</span><br><span class="line">	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:150)</span><br><span class="line">	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)</span><br><span class="line">	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:77)</span><br><span class="line">	at com.test.MybatisAssociatedTest.findOrdersTest(MybatisAssociatedTest.java:36)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)</span><br><span class="line">	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)</span><br><span class="line">	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)</span><br><span class="line">	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)</span><br><span class="line">	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)</span><br><span class="line">	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)</span><br><span class="line">	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)</span><br><span class="line">	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)</span><br><span class="line">	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)</span><br><span class="line">	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)</span><br><span class="line">	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)</span><br><span class="line">	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)</span><br><span class="line">	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)</span><br><span class="line">	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)</span><br><span class="line">	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)</span><br><span class="line">	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47)</span><br><span class="line">	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242)</span><br><span class="line">	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)</span><br><span class="line">Caused by: java.lang.IllegalArgumentException: Mapped Statements collection does not contain value for com.mapper.OrdersMapper.findOrdersWithProduct</span><br><span class="line">	at org.apache.ibatis.session.Configuration$StrictMap.get(Configuration.java:933)</span><br><span class="line">	at org.apache.ibatis.session.Configuration.getMappedStatement(Configuration.java:726)</span><br><span class="line">	at org.apache.ibatis.session.Configuration.getMappedStatement(Configuration.java:719)</span><br><span class="line">	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)</span><br><span class="line">	... 25 more</span><br></pre></td></tr></table></figure></p>
<p>看到报错提示一直以为是数据库访问出现问题，删掉数据库重写一遍发现问题仍然存在，然后一直检查com.mapper.OrdersMapper.findOrdersWithProduct文档中的代码段发现并没有什么问题，谷歌了很多方案也并没有解决掉，当时放弃了，在看了几集《星际迷航：发现号》之后猛然发现这个地方出了问题<br><img src="https://img-blog.csdnimg.cn/20190331181319183.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">应该是 id=”findOrdersWithProductResult” 结果成了 id=”findrOdersWithProduct” 改掉之后运行成功</p>
<h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>需要找一个开源项目好好练习，可以做一个二手商城交易系统，然后以此为蓝本再做一个推荐系统的小项目出来。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-Mybatis初识" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/Mybatis初识/" class="article-date">
  	<time datetime="2019-03-31T14:30:46.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/Mybatis初识/">
        Mybatis初识
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# Mybatis初识<br>mybatis是一个支持普通sql查询，训处过程及高级映射的持久层框架，几乎消除了所偶的JDBC代码和参数的手动设置以及对结果集的检索，使用简单的XMl或注解进行配置和原始的映射</p>
<h2 id="使用log4j输出日志信息"><a href="#使用log4j输出日志信息" class="headerlink" title="使用log4j输出日志信息"></a>使用log4j输出日志信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line">log4j.rootLogger=ERROR, stdout</span><br><span class="line"># MyBatis logging configuration...</span><br><span class="line">log4j.logger.com=DEBUG</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>
<h2 id="新建com-po包，创建Customer类"><a href="#新建com-po包，创建Customer类" class="headerlink" title="新建com.po包，创建Customer类"></a>新建com.po包，创建Customer类</h2> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"> package com.po;</span><br><span class="line"></span><br><span class="line">public class Customer &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String username;</span><br><span class="line">    private String jobs;</span><br><span class="line">    private String phone;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getJobs() &#123;</span><br><span class="line">        return jobs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setJobs(String jobs) &#123;</span><br><span class="line">        this.jobs = jobs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getPhone() &#123;</span><br><span class="line">        return phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPhone(String phone) &#123;</span><br><span class="line">        this.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Customer&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, jobs=&apos;&quot; + jobs + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, phone=&apos;&quot; + phone + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建com-mapper包，并在包中创建映射文件CustomerMapper-xml"><a href="#创建com-mapper包，并在包中创建映射文件CustomerMapper-xml" class="headerlink" title="创建com.mapper包，并在包中创建映射文件CustomerMapper.xml"></a>创建com.mapper包，并在包中创建映射文件CustomerMapper.xml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.CustomerMapper&quot;&gt;</span><br><span class="line">    &lt;!--根据客户编号获取客户信息--&gt;</span><br><span class="line">    &lt;select id=&quot;findCustomerById&quot; parameterType=&quot;Integer&quot; resultType=&quot;com.po.Customer&quot;&gt;</span><br><span class="line">        select * from t_customer where id=#&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">     &lt;!--根据客户名称获取客户信息--&gt;</span><br><span class="line">    &lt;select id=&quot;findCustomerByName&quot; parameterType=&quot;String&quot; resultType=&quot;com.po.Customer&quot;&gt;</span><br><span class="line">        select * from t_customer where username like concat(&apos;%&apos;,#&#123;value&#125;,&apos;%&apos;)</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">     &lt;!--插入信息--&gt;</span><br><span class="line">    &lt;insert id=&quot;addCustomer&quot; parameterType=&quot;com.po.Customer&quot;&gt;</span><br><span class="line">        insert into t_customer(username,jobs,phone)</span><br><span class="line">        values(#&#123;username&#125;,#&#123;jobs&#125;,#&#123;phone&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">     &lt;!--更新客户信息--&gt;</span><br><span class="line">    &lt;update id=&quot;updateCustomer&quot; parameterType=&quot;com.po.Customer&quot;&gt;</span><br><span class="line">        update t_customer set</span><br><span class="line">        username=#&#123;username&#125;,jobs=#&#123;jobs&#125;,phone=#&#123;phone&#125;</span><br><span class="line">        where username=#&#123;username&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">     &lt;!--根据客户编号删除客户信息--&gt;</span><br><span class="line">    &lt;delete id=&quot;deleteCustomer&quot; parameterType=&quot;Integer&quot;&gt;</span><br><span class="line">        delete from t_customer where id=#&#123;id&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h2 id="在src目录下创建mybatis的核心配置文件mybatis-config-xml"><a href="#在src目录下创建mybatis的核心配置文件mybatis-config-xml" class="headerlink" title="在src目录下创建mybatis的核心配置文件mybatis-config.xml"></a>在src目录下创建mybatis的核心配置文件mybatis-config.xml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!--1.配置环境 ，默认的环境id为mysql--&gt;</span><br><span class="line">    &lt;environments default=&quot;mysql&quot;&gt;</span><br><span class="line">        &lt;!--1.2.配置id为mysql的数据库环境 --&gt;</span><br><span class="line">        &lt;environment id=&quot;mysql&quot;&gt;</span><br><span class="line">            &lt;!-- 使用JDBC的事务管理 --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!--数据库连接池 --&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot;</span><br><span class="line">                          value=&quot;jdbc:mysql://localhost:3306/mybatis&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;com/mapper/CustomerMapper.xml&quot; /&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h2 id="创建com-test包，编写每个测试类方法"><a href="#创建com-test包，编写每个测试类方法" class="headerlink" title="创建com.test包，编写每个测试类方法"></a>创建com.test包，编写每个测试类方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">package com.test;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import com.po.Customer;</span><br><span class="line">public class MybatisTest &#123;</span><br><span class="line">    @Test</span><br><span class="line">    public void findCustomerByIdTest() throws Exception&#123;</span><br><span class="line">        String resource = &quot;mybatis-config.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory=new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession sqlSession=sqlSessionFactory.openSession();</span><br><span class="line">        Customer customer=sqlSession.selectOne(&quot;com.mapper&quot;+&quot;.CustomerMapper.findCustomerById&quot;,2);</span><br><span class="line">        System.out.println(customer.toString());</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void findCustomerByNameTest() throws Exception&#123;</span><br><span class="line">        String resource=&quot;mybatis-config.xml&quot;;</span><br><span class="line">        InputStream inputStream=Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory=new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession sqlSession=sqlSessionFactory.openSession();</span><br><span class="line">        List&lt;Customer&gt; customers=sqlSession.selectList(&quot;com.mapper&quot;+&quot;.CustomerMapper.findCustomerByName&quot;,&quot;r&quot;);</span><br><span class="line">        for(Customer customer:customers)&#123;</span><br><span class="line">            System.out.println(customer);</span><br><span class="line">        &#125;</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void addCustomerTest() throws Exception&#123;</span><br><span class="line">        String resource =&quot;mybatis-config.xml&quot;;</span><br><span class="line">        InputStream inputStream=Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory=new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession sqlSession=sqlSessionFactory.openSession();</span><br><span class="line">        Customer customer=new Customer();</span><br><span class="line">        customer.setUsername(&quot;rose&quot;);</span><br><span class="line">        customer.setJobs(&quot;student&quot;);</span><br><span class="line">        customer.setPhone(&quot;13333533092&quot;);</span><br><span class="line">        int rows=sqlSession.insert(&quot;com.mapper&quot;+&quot;.CustomerMapper.addCustomer&quot;,customer);</span><br><span class="line">        if(rows&gt;0)&#123;</span><br><span class="line">            System.out.println(&quot;您成功插入&quot;+rows+&quot;条数据&quot;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            System.out.println(&quot;执行插入操作失败！！！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void updateCustomerTest() throws Exception&#123;</span><br><span class="line">        String resource=&quot;mybatis-config.xml&quot;;</span><br><span class="line">        InputStream inputStream=Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory=new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession sqlSession=sqlSessionFactory.openSession();</span><br><span class="line">        Customer customer=new Customer();</span><br><span class="line">        customer.setId(4);</span><br><span class="line">        customer.setUsername(&quot;rose&quot;);</span><br><span class="line">        customer.setJobs(&quot;programmer&quot;);</span><br><span class="line">        customer.setPhone(&quot;1331111111&quot;);</span><br><span class="line">        int rows=sqlSession.update(&quot;com.mapper&quot;+&quot;.CustomerMapper.updateCustomer&quot;,customer);</span><br><span class="line">        if(rows&gt;0)&#123;</span><br><span class="line">            System.out.println(&quot;您成功修改了&quot;+rows+&quot;条数据&quot;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            System.out.println(&quot;执行修改操作失败！！！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void deleteCustomerTest() throws Exception&#123;</span><br><span class="line">        String resources=&quot;mybatis-config.xml&quot;;</span><br><span class="line">        InputStream inputStream=Resources.getResourceAsStream(resources);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory= new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession sqlSession=sqlSessionFactory.openSession();</span><br><span class="line">        int rows=sqlSession.delete(&quot;com.mapper&quot;+&quot;.CustomerMapper.deleteCustomer&quot;,4);</span><br><span class="line">        if(rows&gt;0)&#123;</span><br><span class="line">            System.out.println(&quot;你成功删除了&quot;+rows+&quot;条数据&quot;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            System.out.println(&quot;执行删除操作失败！！！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>在这次学习过程中遇到的问题如下</p>
<h3 id="一，错误提示java-lang-NoClassDefFoundError-org-hamcrest-SelfDescribing"><a href="#一，错误提示java-lang-NoClassDefFoundError-org-hamcrest-SelfDescribing" class="headerlink" title="一，错误提示java.lang.NoClassDefFoundError:org/hamcrest/SelfDescribing"></a>一，错误提示java.lang.NoClassDefFoundError:org/hamcrest/SelfDescribing</h3><p><img src="https://img-blog.csdnimg.cn/20190328113236846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h5 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h5><p>该错误是由于junit测试中缺少<strong>hamcrest-core.jar</strong>文件所致，添加即可解决问题</p>
<h3 id="二、查询和删除操作失败"><a href="#二、查询和删除操作失败" class="headerlink" title="二、查询和删除操作失败"></a>二、查询和删除操作失败</h3><p><img src="https://img-blog.csdnimg.cn/201903281134137.png" alt="在这里插入图片描述"></p>
<h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><p>先打开数据库，如图所示<br><img src="https://img-blog.csdnimg.cn/20190328113511418.png" alt="在这里插入图片描述"><br>我们发现没有id值为4的数据，因此会出现如下问题，所以我们可以添加一个id=4的数据或者改为按照用户名查询即可，只要符合SQL语法，想怎么该就怎么改。</p>
<h3 id="三、控制台无法输出SQL语句"><a href="#三、控制台无法输出SQL语句" class="headerlink" title="三、控制台无法输出SQL语句"></a>三、控制台无法输出SQL语句</h3><p>如上图所使<br>这种情况绝对是log4j文件编辑错误，不用想其他问题</p>
<h3 id="四、插入数据提示成功后数据库中无相关信息"><a href="#四、插入数据提示成功后数据库中无相关信息" class="headerlink" title="四、插入数据提示成功后数据库中无相关信息"></a>四、插入数据提示成功后数据库中无相关信息</h3><p>这中情况一般是由于事务未提交造成的，检查相关代码中是否有事务提交代码段（sqlSession.commit()）</p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><h3 id="Mybatis的操作大致可以分为如下几个步骤"><a href="#Mybatis的操作大致可以分为如下几个步骤" class="headerlink" title="Mybatis的操作大致可以分为如下几个步骤"></a>Mybatis的操作大致可以分为如下几个步骤</h3><p>1.读取配置文件<br>2.根据配置文件构建SqlSessionFactory<br>3.通过SqlSessionFactory创建SqlSession<br>4.使用SqlSession对象操作数据库<br>5.关闭Sqlsession</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-MyBatis的关系映射——一对一" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/MyBatis的关系映射——一对一/" class="article-date">
  	<time datetime="2019-03-31T14:30:22.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/MyBatis的关系映射——一对一/">
        MyBatis的关系映射——一对一
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# MyBatis的关系映射——一对一</p>
<h2 id="一对一的关系"><a href="#一对一的关系" class="headerlink" title="一对一的关系"></a>一对一的关系</h2><p>定义：在本类中定义对方类型的对象，如A类中定义B类类型的属性b，B类中定义A类类型的属性a</p>
<h3 id="创建相关数据库"><a href="#创建相关数据库" class="headerlink" title="创建相关数据库"></a>创建相关数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">use mybatis;</span><br><span class="line">create table tb_idcard(</span><br><span class="line">        id int primary key auto_increment,</span><br><span class="line">        code varchar(20)</span><br><span class="line">);</span><br><span class="line">insert into tb_idcard(code) values(&apos;152221198711020624&apos;);</span><br><span class="line">insert into tb_idcard(code) values(&apos;152221198711020628&apos;);</span><br><span class="line">create table tb_person(</span><br><span class="line">        id int primary key auto_increment,</span><br><span class="line">        name varchar(32),</span><br><span class="line">        age int,</span><br><span class="line">        sex varchar(8),</span><br><span class="line">        card_id int unique,</span><br><span class="line">        foreign key(card_id) references tb_idcard(id)</span><br><span class="line">);</span><br><span class="line">insert into tb_person(name,age,sex,card_id) values(&apos;Rose&apos;,29.&apos;feman&apos;,1);</span><br><span class="line">insert into tb_person(name,age,sex,card_id) values(&apos;tom&apos;,27.&apos;man&apos;,2);</span><br></pre></td></tr></table></figure>
<h3 id="创建com-po包，编写类IdCard-Person类"><a href="#创建com-po包，编写类IdCard-Person类" class="headerlink" title="创建com.po包，编写类IdCard,Person类"></a>创建com.po包，编写类IdCard,Person类</h3><p>IdCard类如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">public class IdCard &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String code;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getCode() &#123;</span><br><span class="line">        return code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setCode(String code) &#123;</span><br><span class="line">        this.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;IdCard&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, code=&apos;&quot; + code + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Person类如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">public class Person &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Integer age;</span><br><span class="line">    private String sex;</span><br><span class="line">    private IdCard card;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Integer getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(Integer age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getSex() &#123;</span><br><span class="line">        return sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setSex(String sex) &#123;</span><br><span class="line">        this.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public IdCard getCard() &#123;</span><br><span class="line">        return card;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setCard(IdCard card) &#123;</span><br><span class="line">        this.card = card;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Person&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, age=&quot; + age +</span><br><span class="line">                &quot;, sex=&apos;&quot; + sex + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, card=&quot; + card +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="在com-mapper包中创建映射文件IdCardMapper-xml和个人信息类PersonMapper-xml，并在两个映射文件中配置一对一映射查询信息"><a href="#在com-mapper包中创建映射文件IdCardMapper-xml和个人信息类PersonMapper-xml，并在两个映射文件中配置一对一映射查询信息" class="headerlink" title="在com.mapper包中创建映射文件IdCardMapper.xml和个人信息类PersonMapper.xml，并在两个映射文件中配置一对一映射查询信息"></a>在com.mapper包中创建映射文件IdCardMapper.xml和个人信息类PersonMapper.xml，并在两个映射文件中配置一对一映射查询信息</h3><p>IdCardMapper.xml如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.IdCardMapper&quot;&gt;</span><br><span class="line">  &lt;!-- 根据id查询证件信息 --&gt;</span><br><span class="line">  &lt;select id=&quot;findCodeById&quot; parameterType=&quot;Integer&quot; resultType=&quot;IdCard&quot;&gt;</span><br><span class="line">	  SELECT * from tb_idcard where id=#&#123;id&#125;</span><br><span class="line">  &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p>
<p>PersonMapper.xml如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.PersonMapper&quot;&gt;</span><br><span class="line">	&lt;!-- 嵌套查询：通过执行另外一条SQL映射语句来返回预期的特殊类型 --&gt;</span><br><span class="line">	&lt;select id=&quot;findPersonById&quot; parameterType=&quot;Integer&quot; </span><br><span class="line">                                      resultMap=&quot;IdCardWithPersonResult&quot;&gt;</span><br><span class="line">		SELECT * from tb_person where id=#&#123;id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Person&quot; id=&quot;IdCardWithPersonResult&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;age&quot; column=&quot;age&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;sex&quot; column=&quot;sex&quot; /&gt;</span><br><span class="line">		&lt;!-- 一对一：association使用select属性引入另外一条SQL语句 --&gt;</span><br><span class="line">		&lt;association property=&quot;card&quot; column=&quot;card_id&quot; javaType=&quot;IdCard&quot;</span><br><span class="line">			select=&quot;com.mapper.IdCardMapper.findCodeById&quot; /&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="配置mybatis-config-xml文件，映入Mapper映射文件并定义别名"><a href="#配置mybatis-config-xml文件，映入Mapper映射文件并定义别名" class="headerlink" title="配置mybatis-config.xml文件，映入Mapper映射文件并定义别名"></a>配置mybatis-config.xml文件，映入Mapper映射文件并定义别名</h3><h5 id="db-properties文件如下"><a href="#db-properties文件如下" class="headerlink" title="db.properties文件如下"></a>db.properties文件如下</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/mybatis</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=root</span><br></pre></td></tr></table></figure>
<p>这样写的好处是可以直接在该文件下修改数据库用户密码等信息，不需要在mybatis-config,xml修改</p>
<h5 id="使用log4j输出日志信息"><a href="#使用log4j输出日志信息" class="headerlink" title="使用log4j输出日志信息"></a>使用log4j输出日志信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line">log4j.rootLogger=ERROR, stdout</span><br><span class="line"># MyBatis logging configuration...</span><br><span class="line">log4j.logger.com=DEBUG</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>
<h5 id="完整的mybatis-config-xml文件如下"><a href="#完整的mybatis-config-xml文件如下" class="headerlink" title="完整的mybatis-config.xml文件如下"></a>完整的mybatis-config.xml文件如下</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 引入数据库连接配置文件 --&gt;</span><br><span class="line">    &lt;properties resource=&quot;db.properties&quot; /&gt;</span><br><span class="line">    &lt;!--使用扫描包的形式定义别名 --&gt;</span><br><span class="line">    &lt;typeAliases&gt;</span><br><span class="line">        &lt;package name=&quot;com.po&quot; /&gt;</span><br><span class="line">    &lt;/typeAliases&gt;</span><br><span class="line">    &lt;!--配置环境 ，默认的环境id为mysql --&gt;</span><br><span class="line">    &lt;environments default=&quot;mysql&quot;&gt;</span><br><span class="line">        &lt;!-- 配置id为mysql的数据库环境 --&gt;</span><br><span class="line">        &lt;environment id=&quot;mysql&quot;&gt;</span><br><span class="line">            &lt;!-- 使用JDBC的事务管理 --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!--数据库连接池 --&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;!--配置Mapper的位置 --&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;com/mapper/IdCardMapper.xml&quot; /&gt;</span><br><span class="line">        &lt;mapper resource=&quot;com/mapper/PersonMapper.xml&quot; /&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h3 id="创建com-utils包，编写工具类"><a href="#创建com-utils包，编写工具类" class="headerlink" title="创建com.utils包，编写工具类"></a>创建com.utils包，编写工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.utils;</span><br><span class="line">import java.io.Reader;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">public class MybatisUtils &#123;	</span><br><span class="line">    public static SqlSessionFactory sqlSessionFactory = null;</span><br><span class="line">    // 初始化SqlSessionFactory对象</span><br><span class="line">    static&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            //使用MyBatis提供的Resources类加载mybatis的配置文件</span><br><span class="line">            Reader reader = Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;);</span><br><span class="line">            //构建sqlSession的工厂</span><br><span class="line">            sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 获取SqlSession对象的静态方法</span><br><span class="line">    public static SqlSession getSession()&#123;</span><br><span class="line">        return sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="创建com-test包并创建测试类"><a href="#创建com-test包并创建测试类" class="headerlink" title="创建com.test包并创建测试类"></a>创建com.test包并创建测试类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package com.test;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import com.po.Person;</span><br><span class="line">import com.utils.MybatisUtils;</span><br><span class="line">public class MybatisAssociatedTest &#123;</span><br><span class="line">    @Test</span><br><span class="line">    public void findPersonByIdTest() &#123;</span><br><span class="line">        SqlSession session = MybatisUtils.getSession();</span><br><span class="line">        Person person = session.selectOne(&quot;com.mapper.&quot;</span><br><span class="line">                                   + &quot;PersonMapper.findPersonById&quot;, 1);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用junit执行findPersonByIdTest()方法后效果如下<br><img src="https://img-blog.csdnimg.cn/20190331114816406.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZHkxMjMwNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">该方法使用嵌套查询的方式比较简单，但该方法要执行多条SQL语句，对大型数据集合不友好，所以应当使用MyBatis提供的嵌套结果进行关联查询</p>
<h3 id="继续在PersonMapper-xml如下所示代码"><a href="#继续在PersonMapper-xml如下所示代码" class="headerlink" title="继续在PersonMapper.xml如下所示代码"></a>继续在PersonMapper.xml如下所示代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findPersonById2&quot; parameterType=&quot;Integer&quot; resultMap=&quot;IdCardWithPersonResult2&quot;&gt;</span><br><span class="line">		select p.*,idcard.code</span><br><span class="line">		from tb_person p,tb_idcard idcard</span><br><span class="line">		where p.card_id=idcard.id</span><br><span class="line">		and p.id=#&#123;id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Person&quot; id=&quot;IdCardWithPersonResult2&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;age&quot; column=&quot;age&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;sex&quot; column=&quot;sex&quot; /&gt;</span><br><span class="line">		&lt;association property=&quot;card&quot; javaType=&quot;IdCard&quot;&gt;</span><br><span class="line">			&lt;id property=&quot;id&quot; column=&quot;card_id&quot; /&gt;</span><br><span class="line">			&lt;result property=&quot;code&quot; column=&quot;code&quot; /&gt;</span><br><span class="line">		&lt;/association&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>
<h3 id="在测试类中编写findPersonByIdTest2-方法，代码如下"><a href="#在测试类中编写findPersonByIdTest2-方法，代码如下" class="headerlink" title="在测试类中编写findPersonByIdTest2()方法，代码如下"></a>在测试类中编写findPersonByIdTest2()方法，代码如下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">    public void findPersonByIdTest2()&#123;</span><br><span class="line">        SqlSession session=MybatisUtils.getSession();</span><br><span class="line">        Person person = session.selectOne(&quot;com.mapper.&quot;</span><br><span class="line">                + &quot;PersonMapper.findPersonById2&quot;, 1);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>结果如下：<br><img src="https://img-blog.csdnimg.cn/20190331115514934.png" alt="在这里插入图片描述"></p>
<h3 id="遇见问题"><a href="#遇见问题" class="headerlink" title="遇见问题"></a>遇见问题</h3><p>在这次学习过程中遇见的问题如下</p>
<h4 id="1、未使用扫描包的形式定义别名"><a href="#1、未使用扫描包的形式定义别名" class="headerlink" title="1、未使用扫描包的形式定义别名"></a>1、未使用扫描包的形式定义别名</h4><p>错误展示入下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">org.apache.ibatis.exceptions.PersistenceException: </span><br><span class="line">### Error building SqlSession.</span><br><span class="line">### The error may exist in com/mapper/IdCardMapper.xml</span><br><span class="line">### Cause: org.apache.ibatis.builder.BuilderException: Error parsing SQL Mapper Configuration. Cause: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is &apos;com/mapper/IdCardMapper.xml&apos;. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias &apos;IdCard&apos;.  Cause: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)</span><br><span class="line">	at org.apache.ibatis.session.SqlSessionFactoryBuilder.build(SqlSessionFactoryBuilder.java:52)</span><br><span class="line">	at org.apache.ibatis.session.SqlSessionFactoryBuilder.build(SqlSessionFactoryBuilder.java:36)</span><br><span class="line">	at com.utils.MybatisUtils.&lt;clinit&gt;(MybatisUtils.java:16)</span><br><span class="line">	at com.test.MybatisAssociatedTest.findPersonByIdTest2(MybatisAssociatedTest.java:18)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)</span><br><span class="line">	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)</span><br><span class="line">	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)</span><br><span class="line">	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)</span><br><span class="line">	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)</span><br><span class="line">	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)</span><br><span class="line">	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)</span><br><span class="line">	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)</span><br><span class="line">	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)</span><br><span class="line">	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)</span><br><span class="line">	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)</span><br><span class="line">	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)</span><br><span class="line">	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)</span><br><span class="line">	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)</span><br><span class="line">	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)</span><br><span class="line">	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47)</span><br><span class="line">	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242)</span><br><span class="line">	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)</span><br><span class="line">Caused by: org.apache.ibatis.builder.BuilderException: Error parsing SQL Mapper Configuration. Cause: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is &apos;com/mapper/IdCardMapper.xml&apos;. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias &apos;IdCard&apos;.  Cause: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLConfigBuilder.parseConfiguration(XMLConfigBuilder.java:121)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLConfigBuilder.parse(XMLConfigBuilder.java:98)</span><br><span class="line">	at org.apache.ibatis.session.SqlSessionFactoryBuilder.build(SqlSessionFactoryBuilder.java:50)</span><br><span class="line">	... 25 more</span><br><span class="line">Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is &apos;com/mapper/IdCardMapper.xml&apos;. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias &apos;IdCard&apos;.  Cause: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:122)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:94)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLConfigBuilder.mapperElement(XMLConfigBuilder.java:373)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLConfigBuilder.parseConfiguration(XMLConfigBuilder.java:119)</span><br><span class="line">	... 27 more</span><br><span class="line">Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias &apos;IdCard&apos;.  Cause: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:74)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:137)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:130)</span><br><span class="line">	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:120)</span><br><span class="line">	... 30 more</span><br><span class="line">Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias &apos;IdCard&apos;.  Cause: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:120)</span><br><span class="line">	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:149)</span><br><span class="line">	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116)</span><br><span class="line">	... 34 more</span><br><span class="line">Caused by: java.lang.ClassNotFoundException: Cannot find class: IdCard</span><br><span class="line">	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:200)</span><br><span class="line">	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:89)</span><br><span class="line">	at org.apache.ibatis.io.Resources.classForName(Resources.java:261)</span><br><span class="line">	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:116)</span><br><span class="line">	... 36 more</span><br></pre></td></tr></table></figure></p>
<p>有点长最关键的地方就是： <strong> Cannot find class:IdCard</strong><br>解决方案：<br>在mybatis-config.xml配置文件中添加如下代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;typeAliases&gt;</span><br><span class="line">        &lt;package name=&quot;com.po&quot; /&gt; //com.po为自定义类的包名</span><br><span class="line">    &lt;/typeAliases&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>对于MyBatis配置方面还是不太熟悉，还得继续学习关于MyBatis配置方面的内容</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-MyBatis的关系映射——一对多" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/MyBatis的关系映射——一对多/" class="article-date">
  	<time datetime="2019-03-31T14:29:57.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/MyBatis的关系映射——一对多/">
        MyBatis的关系映射——一对多
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# MyBatis的关系映射——一对多</p>
<h2 id="一对多的关系"><a href="#一对多的关系" class="headerlink" title="一对多的关系"></a>一对多的关系</h2><p>定义：一个A类类型对应多个B类类型，需要在A类中以集合的方式引入B类类型对象，在B类中定义A类类型的属性a。</p>
<h3 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h3><p>案例中所需要的数据库如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">create table tb_user(</span><br><span class="line">id int(32) primary key auto_increment,</span><br><span class="line">username varchar(32),</span><br><span class="line">address varchar(256)</span><br><span class="line">);</span><br><span class="line">insert into tb_user values(&apos;1&apos;,&apos;jams&apos;,&apos;kelifulan&apos;);</span><br><span class="line">insert into tb_user values(&apos;2&apos;,&apos;kebi&apos;,&apos;sanfrancisd&apos;);</span><br><span class="line">insert into tb_user values(&apos;3&apos;,&apos;baoluo&apos;,&apos;huashengt&apos;);</span><br><span class="line">create table tb_orders(</span><br><span class="line">id int(32) primary key auto_increment,</span><br><span class="line">number varchar(32) not null,</span><br><span class="line">user_id int(32) not null,</span><br><span class="line">foreign key(user_id) references tb_user(id)</span><br><span class="line">);</span><br><span class="line">insert into tb_orders values(&apos;1&apos;,&apos;100011&apos;,&apos;1&apos;);</span><br><span class="line">insert into tb_orders values(&apos;2&apos;,&apos;100012&apos;,&apos;1&apos;);</span><br><span class="line">insert into tb_orders values(&apos;3&apos;,&apos;100013&apos;,&apos;3&apos;);</span><br></pre></td></tr></table></figure></p>
<p>完整的文件路径如下所示：<br><img src="https://img-blog.csdnimg.cn/20190331173123437.png" alt="完整的文件路径"></p>
<h3 id="2、创建com-po包，创建类Orders和User，并在类中定义相关属性和方法"><a href="#2、创建com-po包，创建类Orders和User，并在类中定义相关属性和方法" class="headerlink" title="2、创建com.po包，创建类Orders和User，并在类中定义相关属性和方法"></a>2、创建com.po包，创建类Orders和User，并在类中定义相关属性和方法</h3><h5 id="Orders类如下所示"><a href="#Orders类如下所示" class="headerlink" title="Orders类如下所示"></a>Orders类如下所示</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">public class Orders &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String number;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getNumber() &#123;</span><br><span class="line">        return number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setNumber(String number) &#123;</span><br><span class="line">        this.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Orders&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, number=&apos;&quot; + number + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="User类如下所示"><a href="#User类如下所示" class="headerlink" title="User类如下所示"></a>User类如下所示</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">package com.po;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String username;</span><br><span class="line">    private String address;</span><br><span class="line">    private List&lt;Orders&gt; ordersList;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAddress() &#123;</span><br><span class="line">        return address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAddress(String address) &#123;</span><br><span class="line">        this.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public List&lt;Orders&gt; getOrdersList() &#123;</span><br><span class="line">        return ordersList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setOrdersList(List&lt;Orders&gt; ordersList) &#123;</span><br><span class="line">        this.ordersList = ordersList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, address=&apos;&quot; + address + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, ordersList=&quot; + ordersList +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、创建com-mapper包并创建用户实体映射文件UserMapper-xml并编写一对多关联映射查询配置"><a href="#3、创建com-mapper包并创建用户实体映射文件UserMapper-xml并编写一对多关联映射查询配置" class="headerlink" title="3、创建com.mapper包并创建用户实体映射文件UserMapper.xml并编写一对多关联映射查询配置"></a>3、创建com.mapper包并创建用户实体映射文件UserMapper.xml并编写一对多关联映射查询配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;!-- namespace表示命名空间 --&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.mapper.UserMapper&quot;&gt;</span><br><span class="line">    &lt;!-- 一对多：查看某一用户及其关联的订单信息</span><br><span class="line">          注意：当关联查询出的列名相同，则需要使用别名区分 --&gt;</span><br><span class="line">    &lt;select id=&quot;findUserWithOrders&quot; parameterType=&quot;Integer&quot;</span><br><span class="line">            resultMap=&quot;UserWithOrdersResult&quot;&gt;</span><br><span class="line">		SELECT u.*,o.id as orders_id,o.number</span><br><span class="line">		from tb_user u,tb_orders o</span><br><span class="line">		WHERE u.id=o.user_id</span><br><span class="line">         and u.id=#&#123;id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">    &lt;resultMap type=&quot;User&quot; id=&quot;UserWithOrdersResult&quot;&gt;</span><br><span class="line">        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;address&quot; column=&quot;address&quot;/&gt;</span><br><span class="line">        &lt;!-- 一对多关联映射：collection</span><br><span class="line">            ofType表示属性集合中元素的类型，List&lt;Orders&gt;属性即Orders类 --&gt;</span><br><span class="line">        &lt;collection property=&quot;ordersList&quot; ofType=&quot;Orders&quot;&gt;</span><br><span class="line">            &lt;id property=&quot;id&quot; column=&quot;orders_id&quot;/&gt;</span><br><span class="line">            &lt;result property=&quot;number&quot; column=&quot;number&quot;/&gt;</span><br><span class="line">        &lt;/collection&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4、创建mybatis-config-xml文件并将映射文件UserMapper-xml配置到该文件中"><a href="#4、创建mybatis-config-xml文件并将映射文件UserMapper-xml配置到该文件中" class="headerlink" title="4、创建mybatis-config.xml文件并将映射文件UserMapper.xml配置到该文件中"></a>4、创建mybatis-config.xml文件并将映射文件UserMapper.xml配置到该文件中</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 引入数据库连接配置文件 --&gt;</span><br><span class="line">    &lt;properties resource=&quot;db.properties&quot; /&gt;</span><br><span class="line">    &lt;!--使用扫描包的形式定义别名 --&gt;</span><br><span class="line">    &lt;typeAliases&gt;</span><br><span class="line">        &lt;package name=&quot;com.po&quot; /&gt;</span><br><span class="line">    &lt;/typeAliases&gt;</span><br><span class="line">    &lt;!--配置环境 ，默认的环境id为mysql --&gt;</span><br><span class="line">    &lt;environments default=&quot;mysql&quot;&gt;</span><br><span class="line">        &lt;!-- 配置id为mysql的数据库环境 --&gt;</span><br><span class="line">        &lt;environment id=&quot;mysql&quot;&gt;</span><br><span class="line">            &lt;!-- 使用JDBC的事务管理 --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!--数据库连接池 --&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;com/mapper/UserMapper.xml&quot; /&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<p>这步的配置过程其实和上一篇博客<a href="https://blog.csdn.net/zhangdy12307/article/details/88926590" target="_blank" rel="noopener">MyBatis的关系映射——一对一</a>中的配置方法一样。</p>
<h3 id="5、创建com-utils包并编写工具类"><a href="#5、创建com-utils包并编写工具类" class="headerlink" title="5、创建com.utils包并编写工具类"></a>5、创建com.utils包并编写工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.utils;</span><br><span class="line">import java.io.Reader;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">public class MybatisUtils &#123;	</span><br><span class="line">    public static SqlSessionFactory sqlSessionFactory = null;</span><br><span class="line">    // 初始化SqlSessionFactory对象</span><br><span class="line">    static&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            //使用MyBatis提供的Resources类加载mybatis的配置文件</span><br><span class="line">            Reader reader = Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;);</span><br><span class="line">            //构建sqlSession的工厂</span><br><span class="line">            sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 获取SqlSession对象的静态方法</span><br><span class="line">    public static SqlSession getSession()&#123;</span><br><span class="line">        return sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、创建测试类com-test并编写findUserTest-方法"><a href="#6、创建测试类com-test并编写findUserTest-方法" class="headerlink" title="6、创建测试类com.test并编写findUserTest()方法"></a>6、创建测试类com.test并编写findUserTest()方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.test;</span><br><span class="line">import com.po.Orders;</span><br><span class="line">import com.po.User;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import com.po.Person;</span><br><span class="line">import com.utils.MybatisUtils;</span><br><span class="line">public class MybatisAssociatedTest &#123;</span><br><span class="line">    @Test</span><br><span class="line">    public void findUserTest()&#123;</span><br><span class="line">        SqlSession session=MybatisUtils.getSession();</span><br><span class="line">        User user=session.selectOne(&quot;com.mapper.&quot;+&quot;UserMapper.findUserWithOrders&quot;,1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行后结果如下<br><img src="https://img-blog.csdnimg.cn/20190331174721817.png" alt="在这里插入图片描述"></p>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>这次没有遇到</p>
<h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>MyBatis是通过<collection>元素处理一对多的关联关系，<collection>子元素的属性大部分与<association>属性相同，除属性ofType,OfType属性用于指定实体对象中集合类属性所包含元素类型。<br>这篇博客的内容其实也可以直接将所有的文件添加在上一篇博文中所创建的项目文件中，当然重新创建项目也是可以的。</association></collection></collection></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-Python数据挖掘入门与实践-OneR分类算法" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/31/Python数据挖掘入门与实践-OneR分类算法/" class="article-date">
  	<time datetime="2019-03-31T14:28:50.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/Python数据挖掘入门与实践-OneR分类算法/">
        Python数据挖掘入门与实践-OneR分类算法
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>﻿# Python数据挖掘入门与实践-OneR分类算法</p>
<h3 id="OneR算法"><a href="#OneR算法" class="headerlink" title="OneR算法"></a>OneR算法</h3><p>OneR算法是根据已有的数据中，具有相同特征值的个体最可能属于哪个类别进行分类。<br>在本例中，只需选区Iris是个特征中分类效果最好的一个作为分类依据。</p>
<h2 id="使用OneR算法对植物进行分类"><a href="#使用OneR算法对植物进行分类" class="headerlink" title="使用OneR算法对植物进行分类"></a>使用OneR算法对植物进行分类</h2><h3 id="离散化"><a href="#离散化" class="headerlink" title="离散化"></a>离散化</h3><p>数据集的特征为连续值，把连续值转变为类别行，这个过程叫作离散化。</p>
<h3 id="1、准备数据集"><a href="#1、准备数据集" class="headerlink" title="1、准备数据集"></a>1、准备数据集</h3><p>每条数据集中给出了四个特征：sepal length,sepal width,petal length,petal width，可以从sklearn-learn使用该数据集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.datasets import load_iris</span><br><span class="line">import numpy as np</span><br><span class="line">dataset = load_iris()</span><br><span class="line">print(dataset.DESCR)</span><br><span class="line">X = dataset.data</span><br><span class="line">y = dataset.target</span><br></pre></td></tr></table></figure></p>
<h3 id="2、数据处理"><a href="#2、数据处理" class="headerlink" title="2、数据处理"></a>2、数据处理</h3><p>使用离散化算法确定数据，通过确定一个阈值，将低于该阈值的特征值置为0，高于阈值的置为1，设每个特征的阈值为所有特征的均值，计算方法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">attribute_means = X.mean()</span><br></pre></td></tr></table></figure></p>
<p>进行类型转换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_d = np.array(X &gt;= attribute_means, dtype=&apos;int&apos;)</span><br></pre></td></tr></table></figure></p>
<h3 id="3、实现OneR算法"><a href="#3、实现OneR算法" class="headerlink" title="3、实现OneR算法"></a>3、实现OneR算法</h3><p>通过OneR算法，我们将计算按照每个特征进行分类的错误率，然后选区错误率最低的特征作为分类准则，<br>首先创建函数，参数分别是数据集，类别数组，选好的特征索引值，特征值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from collections import defaultdict</span><br><span class="line">from operator import itemgetter</span><br><span class="line">def train_feature_value(X, y_true, feature_index, value):</span><br><span class="line">    class_counts = defaultdict(int)</span><br><span class="line">    for sample, y in zip(X, y_true):</span><br><span class="line">        if sample[feature_index] == value:</span><br><span class="line">            class_counts[y] += 1</span><br><span class="line">    sorted_class_counts = sorted(class_counts.items(),key=itemgetter(1), reverse=True)</span><br><span class="line">    most_frequent_class = sorted_class_counts[0][0]</span><br><span class="line">    incorrect_predictions = [class_count for class_value,class_count in class_counts.items() if class_value != most_frequent_class]</span><br><span class="line">    error = sum(incorrect_predictions)</span><br><span class="line">    return most_frequent_class, error</span><br></pre></td></tr></table></figure></p>
<p>对于任意一项特征，遍历其中每一个特征值使用上述函数计算错误率。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def train_on_feature(X, y_true, feature_index):</span><br><span class="line">    values = set(X[:,feature_index])</span><br><span class="line">    #字典predictors作为预测器，字典的键位特征值，值为类别</span><br><span class="line">    #errors表示每个特征值的错误率</span><br><span class="line">    predictors = &#123;&#125;</span><br><span class="line">    errors = []</span><br><span class="line">    #调用函数记录每个特征值可能的类别，计算错误率并保存到predictor中</span><br><span class="line">    for current_value in values:</span><br><span class="line">        most_frequent_class, error = train_feature_value(X,y_true, feature_index, current_value)</span><br><span class="line">        predictors[current_value] = most_frequent_class</span><br><span class="line">        errors.append(error)</span><br><span class="line">    total_error = sum(errors)</span><br><span class="line">    return predictors, total_error</span><br></pre></td></tr></table></figure></p>
<h3 id="4、测试算法"><a href="#4、测试算法" class="headerlink" title="4、测试算法"></a>4、测试算法</h3><p>切割数据集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.cross_validation import train_test_split</span><br><span class="line">Xd_train, Xd_test, y_train, y_test = train_test_split(X_d, y, random_state=14)</span><br></pre></td></tr></table></figure></p>
<p>接下来计算所有特征值的目标类别（预测器）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">all_predictors = &#123;&#125;</span><br><span class="line">errors = &#123;&#125;</span><br><span class="line">for feature_index in range(Xd_train.shape[1]):</span><br><span class="line">    predictors, total_error = train_on_feature(Xd_train,y_train,feature_index)</span><br><span class="line">    all_predictors[feature_index] = predictors</span><br><span class="line">    errors[feature_index] = total_error</span><br></pre></td></tr></table></figure></p>
<p>找出错误率最低的特征，作为分类准则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">best_feature, best_error = sorted(errors.items(), key=itemgetter(1))[0]</span><br></pre></td></tr></table></figure></p>
<p>对预测器进行排序，找出最佳特征并创建model模型，创建函数通过遍历数据集中每条数据完成预测<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = &#123;&apos;feature&apos;: best_feature,&apos;predictor&apos;: all_predictors[best_feature]&#125;</span><br><span class="line"></span><br><span class="line">def predict(X_test, model):</span><br><span class="line">    feature = model[&apos;feature&apos;]</span><br><span class="line">    predictor = model[&apos;predictor&apos;]</span><br><span class="line">    y_predicted = [predictor[int(sample[feature])] for sample in X_test]</span><br><span class="line">    return y_predicted</span><br></pre></td></tr></table></figure></p>
<p>比较结果和实际类别进行预测，得出正确率<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y_predicted = predict(Xd_test, model)</span><br><span class="line">accuracy = np.mean(y_predicted == y_test) * 100</span><br><span class="line">print(&quot;The test accuracy is &#123;:.1f&#125;%&quot;.format(accuracy))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdnimg.cn/20190330235116229.png" alt="运行结果"></p>
<h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>OneR算法的思路很简单，但是整个编程过程对于新手来说比较复杂，还是需要加强算法和数据结构方面的练习。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据挖掘/">数据挖掘</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-poj-1509" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/21/poj-1509/" class="article-date">
  	<time datetime="2019-03-20T23:45:29.000Z" itemprop="datePublished">2019-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/21/poj-1509/">
        poj-1509
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="题目分类：环形字符串下的字典序"><a href="#题目分类：环形字符串下的字典序" class="headerlink" title="题目分类：环形字符串下的字典序"></a>题目分类：环形字符串下的字典序</h2><h3 id="题目名称：玻璃珠"><a href="#题目名称：玻璃珠" class="headerlink" title="题目名称：玻璃珠"></a>题目名称：玻璃珠</h3><h3 id="题目链接：玻璃珠"><a href="#题目链接：玻璃珠" class="headerlink" title="题目链接：玻璃珠 "></a>题目链接：<a href="http://poj.org/problem?id=1509" target="_blank" rel="noopener">玻璃珠 </a></h3><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Once upon a time there was a famous actress. As you may expect, she played mostly Antique Comedies most of all. All the people loved her. But she was not interested in the crowds. Her big hobby were beads of any kind. Many bead makers were working for her and they manufactured new necklaces and bracelets every day. One day she called her main Inspector of Bead Makers (IBM) and told him she wanted a very long and special necklace.</p>
<p>The necklace should be made of glass beads of different sizes connected to each other but without any thread running through the beads, so that means the beads can be disconnected at any point. The actress chose the succession of beads she wants to have and the IBM promised to make the necklace. But then he realized a problem. The joint between two neighbouring beads is not very robust so it is possible that the necklace will get torn by its own weight. The situation becomes even worse when the necklace is disjoined. Moreover, the point of disconnection is very important. If there are small beads at the beginning, the possibility of tearing is much higher than if there were large beads. IBM wants to test the robustness of a necklace so he needs a program that will be able to determine the worst possible point of disjoining the beads.</p>
<p>The description of the necklace is a string A = a1a2 … am specifying sizes of the particular beads, where the last character am is considered to precede character a1 in circular fashion.</p>
<p>The disjoint point i is said to be worse than the disjoint point j if and only if the string aiai+1 … ana1 … ai-1 is lexicografically smaller than the string ajaj+1 … ana1 … aj-1. String a1a2 … an is lexicografically smaller than the string b1b2 … bn if and only if there exists an integer i, i &lt;= n, so that aj=bj, for each j, 1 &lt;= j &lt; i and ai &lt; bi</p>
<h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>The input consists of N cases. The first line of the input contains only positive integer N. Then follow the cases. Each case consists of exactly one line containing necklace description. Maximal length of each description is 10000 characters. Each bead is represented by a lower-case character of the english alphabet (a–z), where a &lt; b … z. </p>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>For each case, print exactly one line containing only one integer – number of the bead which is the first at the worst possible disjoining, i.e.\ such i, that the string A[i] is lexicographically smallest among all the n possible disjoinings of a necklace. If there are more than one solution, print the one with the lowest i. </p>
<h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><p>4<br>helloworld<br>amandamanda<br>dontcallmebfu<br>aaabaaa</p>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><p>10<br>11<br>6<br>5</p>
<h3 id="题意如下："><a href="#题意如下：" class="headerlink" title="题意如下："></a>题意如下：</h3><p>给定一条字符串，首尾相连，求从哪里断开的字符串有最小的字典序</p>
<h3 id="代码实现如下"><a href="#代码实现如下" class="headerlink" title="代码实现如下"></a>代码实现如下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;string&gt;</span><br><span class="line">#include&lt;cstring&gt;</span><br><span class="line">#include&lt;cstdio&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">string s;</span><br><span class="line">int n;</span><br><span class="line"></span><br><span class="line">int solve()</span><br><span class="line">&#123;</span><br><span class="line">	int i,j,l;</span><br><span class="line">	i=0;</span><br><span class="line">	j=1;</span><br><span class="line">	int m=s.length();</span><br><span class="line">	//这个while的意思是跳过字符串字符相同的位置</span><br><span class="line">	while(i&lt;m&amp;&amp;j&lt;m)&#123;</span><br><span class="line">		for(l=0;l&lt;m;l++)&#123;</span><br><span class="line">			if(s[(i+l)%m]!=s[(j+l)%m])&#123;            </span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		if(l&gt;m) break;</span><br><span class="line">		if(s[(i+l)%m]&gt;s[(j+l)%m])&#123;</span><br><span class="line">			i+=l+1;</span><br><span class="line">		&#125;else j+=l+1;</span><br><span class="line">		if(i==j) j=i+1;;</span><br><span class="line">	&#125;</span><br><span class="line">    return i&lt;j?i:j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">     //关于feropen这个写法是我从码农场学来的，每次运行后可以直接从文本读取数据</span><br><span class="line">//	freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	while(n--)&#123;</span><br><span class="line">		cin&gt;&gt;s;</span><br><span class="line">		cout&lt;&lt;solve()+1&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/poj/">poj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/字符串/">字符串</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[layout]-Spring操作数据库" class="article article-type-[layout]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/20/Spring操作数据库/" class="article-date">
  	<time datetime="2019-03-20T15:30:54.000Z" itemprop="datePublished">2019-03-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/20/Spring操作数据库/">
        Spring操作数据库
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Spring数据库使用"><a href="#Spring数据库使用" class="headerlink" title="Spring数据库使用"></a>Spring数据库使用</h1><p>这是同样的博客内容，我在csdn中也写了一篇，csdn给人的感觉还是不错的。</p>
<h2 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h2><p>在目前阶段，所使用的开发环境主要如下<br>IDEA2018.2.5<br>Spring-5.1.4</p>
<h2 id="使用前配置"><a href="#使用前配置" class="headerlink" title="使用前配置"></a>使用前配置</h2><p>1.在工具栏中点击file，在下拉列表中选择Project Structure,打开后界面如下所示，按照如Modules，Dependencies，+ 三步选择打开文件夹选择所需要的jar文件，所需要的文件如下<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/所有jar文件.png" alt=""><br>所需要的jar文件<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/H~6[IJ@UF`1FPAJ]0LQ~6R5.png" alt=""> </p>
<h2 id="创建类并定义类的属性"><a href="#创建类并定义类的属性" class="headerlink" title="创建类并定义类的属性"></a>创建类并定义类的属性</h2><p>新建一个包，创Account类，类的的属性如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package com.jdbc;</span><br><span class="line"></span><br><span class="line">public class Account &#123;</span><br><span class="line">    private Integer id;</span><br><span class="line">    private String username;</span><br><span class="line">    private Double balance;</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Account&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, balance=&quot; + balance +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line">    public Double getBalance() &#123;</span><br><span class="line">        return balance;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setBalance(Double balance) &#123;</span><br><span class="line">        this.balance = balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">~~~                  </span><br><span class="line"></span><br><span class="line">## 编写配置文件</span><br></pre></td></tr></table></figure></p>
<p>&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;</p>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-4.3.xsd"><br>    <!-- 1配置数据源 --><br>    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"><br>        <!--数据库驱动 --><br>        <property name="driverClassName" value="com.mysql.jdbc.Driver"><br>        <!--连接数据库的url --><br>        <!--如果Mysql数据库的端口为3306则可以不填写端口号 --><br>        <property name="url" value="jdbc:mysql://localhost/spring"><br>        <!--连接数据库的用户名 --><br>        <property name="username" value="root"><br>        <!--连接数据库的密码 --><br>        <property name="password" value="root"><br>    </property></property></property></property></bean><br>    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"><br>        <!-- 默认必须使用数据源 --><br>        <property name="dataSource" ref="dataSource"><br>    </property></bean><br><br>    <!--定义id为accountDao的Bean--><br>    <bean id="accountDao" class="com.jdbc.AccountDaoImpl"><br>        <property name="jdbcTemplate" ref="jdbcTemplate"><br>    </property></bean><br></beans>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 创建类的接口 </span><br><span class="line">      </span><br><span class="line">定义Account类的接口 AccountDao</span><br></pre></td></tr></table></figure>
<p>package com.jdbc;</p>
<p>import java.util.List;</p>
<p>public interface AccountDao {<br>    public int addAccount(Account account);<br>    public int updateAccount(Account account);<br>    public int deleteAccount(int id);<br>    public Account findAccountById(int id);<br>    public List<account> findAllAccount();<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 创建接口的实现类</span><br><span class="line"></span><br><span class="line">创建Account类的接口的实现类AccountDaoImpl</span><br></pre></td></tr></table></figure></account></p>
<p>package com.jdbc;</p>
<p>import org.springframework.dao.EmptyResultDataAccessException;<br>import org.springframework.jdbc.core.BeanPropertyRowMapper;<br>import org.springframework.jdbc.core.JdbcTemplate;<br>import org.springframework.jdbc.core.RowMapper;</p>
<p>import java.util.List;</p>
<p>public class AccountDaoImpl implements AccountDao {<br>// 声明JdbcTemplate的属性及其setter方法<br>    private JdbcTemplate jdbcTemplate;<br>    public void setJdbcTemplate(JdbcTemplate jdbcTemplate){<br>        this.jdbcTemplate=jdbcTemplate;<br>    }<br>    //向数据库中添加输入<br>    public int addAccount(Account account) {<br>        String sql=”insert into account(username,balance) value(?,?)”;<br>        Object[] obj=new Object[]{<br>                account.getUsername(),<br>                account.getBalance()<br>        };<br>        int num=this.jdbcTemplate.update(sql,obj);    //受影响的行数<br>        return num;<br>    }<br>// 更新账户信息<br>    public int updateAccount(Account account) {<br>        String sql=”update account set username=?,balance=? where id=?”;<br>        Object[] obj=new Object[]{<br>                account.getUsername(),<br>                account.getBalance(),<br>                account.getId()<br>        };<br>        int num=this.jdbcTemplate.update(sql,obj);<br>        return num;<br>    }<br>// 根据Id值删除账户信息<br>    public int deleteAccount(int id) {<br>        String sql=”delete from account where id=?”;<br>        int num=this.jdbcTemplate.update(sql,id);<br>        return num;<br>    }<br>//根据Id值查找账户信息<br>    public Account findAccountById(int id) {<br>        String sql = “select <em> from account where id = ?”;<br>        RowMapper<account> rowMapper = new BeanPropertyRowMapper<account>(Account.class);<br>       try{<br>           return this.jdbcTemplate.queryForObject(sql, rowMapper, id);<br>       }catch (EmptyResultDataAccessException e){<br>           return null;<br>       }<br>    }<br>//显示全部账户信息<br>    public List<account> findAllAccount(){<br>        String sql=”select </account></account></account></em> from account”;<br>        RowMapper<account> rowMapper=new BeanPropertyRowMapper<account>(Account.class);<br>        return this.jdbcTemplate.query(sql,rowMapper);<br>    }<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 编写测试类</span><br></pre></td></tr></table></figure></account></account></p>
<p>package com.jdbc;<br>import org.junit.Test;<br>import org.springframework.context.ApplicationContext;<br>import org.springframework.context.support.ClassPathXmlApplicationContext;<br>import org.springframework.jdbc.core.JdbcTemplate;</p>
<p>import java.util.List;</p>
<p>public class jdbcTemplateTest {<br>    public static void main(String[] args){<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        JdbcTemplate jdbcTemplate=(JdbcTemplate) applicationContext.getBean(“jdbcTemplate”);<br>        jdbcTemplate.execute(“create table account(“ +<br>                “id int primary key auto_increment,”+<br>                “username varchar(50),”+<br>                “balance double)”);<br>        System.out.println(“账户表account创建成功”);<br>    }<br>    @Test<br>    public void addAccountTest(){<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        AccountDao accountDao=(AccountDao) applicationContext.getBean(“accountDao”);<br>        Account account=new Account();<br>        account.setUsername(“tom”);<br>        account.setBalance(1000.00);<br>        int num=accountDao.addAccount(account);<br>        if(num&gt;0) System.out.println(“成功插入了”+num+”条信息”);<br>        else System.out.println(“插入操作执行失败”);<br>    }<br>    @Test<br>    public void updateAccountTest(){<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        AccountDao accountDao=(AccountDao) applicationContext.getBean(“accountDao”);<br>        Account account=new Account();<br>        account.setId(1);<br>        account.setUsername(“tom”);<br>        account.setBalance(2000.00);<br>        int num=accountDao.updateAccount(account);<br>        if(num&gt;0) System.out.println(“成功修改了”+num+”条记录”);<br>        else System.out.println(“修改操作执行失败！”);<br>    }<br>    @Test<br>    public void deleteAccount(){<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        AccountDao accountDao=(AccountDao) applicationContext.getBean(“accountDao”);<br>        int num=accountDao.deleteAccount(1);<br>        if(num&gt;0) System.out.println(“成功删除”+num+”条记录”);<br>        else System.out.println(“删除操作执行失败！”);<br>    }<br>    @Test<br>    public void findAccountByIdTest() {<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        AccountDao accountDao=(AccountDao) applicationContext.getBean(“accountDao”);<br>        Account account = accountDao.findAccountById(1);<br>        System.out.println(account);<br>    }<br>   @Test<br>    public void findAllAccountTest(){<br>        ApplicationContext applicationContext=new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>        AccountDao accountDao=(AccountDao) applicationContext.getBean(“accountDao”);<br>        List<account> account=accountDao.findAllAccount();<br>        for(Account act:account){<br>            System.out.println(act);<br>        }<br>    }<br>}<br>~~~</account></p>
<h2 id="所遇到的问题"><a href="#所遇到的问题" class="headerlink" title="所遇到的问题"></a>所遇到的问题</h2><p>在这个过程中，我遇到了如下的问题</p>
<h5 id="一"><a href="#一" class="headerlink" title="一"></a>一</h5><p>报错提示如下method findAccountByIdTest should have no parameters<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/错误一.png" alt=""><br>刚开始的时候没仔细看报错的内容，一股脑的去百度，找了一堆却没有一个是正确的，后来仔细看错误提示才明白，问题所在，然后查找junit使用注意事项后才明白</p>
<h6 id="junit4-12-版本中-test-对应的测试类不需要参数，有参数会提示"><a href="#junit4-12-版本中-test-对应的测试类不需要参数，有参数会提示" class="headerlink" title="junit4.12 版本中 @test 对应的测试类不需要参数，有参数会提示"></a>junit4.12 版本中<strong> @test </strong>对应的测试类不需要参数，有参数会提示</h6><h5 id="二"><a href="#二" class="headerlink" title="二"></a>二</h5><p>org.springframework.dao.EmptyResultDataAccessException: Incerrect result size: expected 1,actual 0<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/错误二.png" alt=""> </p>
<h6 id="这段报错的意思是没有查询到结果，返回值为空"><a href="#这段报错的意思是没有查询到结果，返回值为空" class="headerlink" title="这段报错的意思是没有查询到结果，返回值为空"></a>这段报错的意思是没有查询到结果，返回值为空</h6><p>刚刚开始觉得不可思议，后来打开数据库发现确实没有这个ID值所对应的数据，所以我在相应的语句段中加入了try-catch异常处理，处理结果为空的结果，关于这个问题我下次一定要在每个查询操作中处理返回值为空的情况。</p>
<h3 id="关于junit"><a href="#关于junit" class="headerlink" title="关于junit"></a>关于junit</h3><p>在整个过程中junit所需要的所有的文件夹都在idea安装目录下的lib文件夹内，可以直接使用，无需从其他地方下载。直接添加 junit.jar， junit-4.12.jar以及hamcrest-core文件夹，如下图<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/junit所需jar文件.png" alt=""><br>在使用junit的时候，先写@Test表明测试位置，然后Idea会自动在左侧栏中显示一个绿色的三角号，如下<br><img src="/media/zhang/Ubuntu/rootdeng77/source/_posts/Spring操作数据库/M6L6L%XOP4BG@Z~0%{1Z[_S.png" alt=""> </p>
<h4 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h4><p>我想和你们一样厉害，哇。。。。。。。。。。。。。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="[post]-2019-3-7" class="article article-type-[post]" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/07/2019-3-7/" class="article-date">
  	<time datetime="2019-03-07T15:13:53.000Z" itemprop="datePublished">2019-03-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/07/2019-3-7/">
        WordCount
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MapReduce之词频统计"><a href="#MapReduce之词频统计" class="headerlink" title="MapReduce之词频统计"></a>MapReduce之词频统计</h1><p>  这次终于开始了这是的MapReduce的编码过程，记录以下</p>
<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>   编写MapReduce对一个文本中单词的使用频率进行统计</p>
<h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><p> hello world<br> hello hadoop<br> hello mapreduce<br> hello spark<br> hello school</p>
<h4 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h4><p>hadoop    1<br>hello    5<br>mapreduce    1<br>school    1<br>spark    1<br>world    1</p>
<h2 id="问题思路"><a href="#问题思路" class="headerlink" title="问题思路"></a>问题思路</h2><p>   在这个问题中，将文本中的内容切割为每一个单词，然后将相同的单词聚集在一起，最后计算此书并输出</p>
<h3 id="map阶段任务"><a href="#map阶段任务" class="headerlink" title="map阶段任务"></a>map阶段任务</h3><p>   在这个问题中，map阶段主要负责单词切割任务。</p>
<h4 id="map阶段的工作原理"><a href="#map阶段的工作原理" class="headerlink" title="map阶段的工作原理"></a>map阶段的工作原理</h4><p>   Mapper处理的数据是由InputFormat分解过的数据集，其中InputFormat的作用是将数据集切割成小数据集InputSplits,每一个InputSplit将由一个Mapper负责处理，此外，InputFormat中还提供了一个RecordReader的实现，并将一个InputSolit解析成&lt; key,value&gt;对提供给map函数。</p>
<h4 id="map阶段源码如下"><a href="#map阶段源码如下" class="headerlink" title="map阶段源码如下"></a>map阶段源码如下</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static class TokenizerMapper</span><br><span class="line">           extends Mapper&lt;Object, Text, Text, IntWritable&gt; &#123;</span><br><span class="line"></span><br><span class="line">       private final static IntWritable one = new IntWritable(1);</span><br><span class="line">       private Text word = new Text();</span><br><span class="line"></span><br><span class="line">       public void map(Object key, Text value, Context context</span><br><span class="line">       ) throws IOException, InterruptedException &#123;</span><br><span class="line">           StringTokenizer itr = new StringTokenizer(value.toString());</span><br><span class="line">           while (itr.hasMoreTokens()) &#123;</span><br><span class="line">               word.set(itr.nextToken());</span><br><span class="line">               context.write(word, one);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="reduce阶段任务"><a href="#reduce阶段任务" class="headerlink" title="reduce阶段任务"></a>reduce阶段任务</h3><p>   reduce阶段主要是接收map结算的单词分组，然后对单词进行统计。</p>
<h4 id="reduce阶段工作原理"><a href="#reduce阶段工作原理" class="headerlink" title="reduce阶段工作原理"></a>reduce阶段工作原理</h4><p>  Mapper中传递的数据为的结果对&lt;key,value&gt;，会送到Reducer中进行合并，合并的过程中，有相同的key的键/值对则送到同一个Reducer上，并由reduce具体计算出单词所对应的频数。</p>
<h4 id="reduce阶段源码如下"><a href="#reduce阶段源码如下" class="headerlink" title="reduce阶段源码如下"></a>reduce阶段源码如下</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static class IntSumReducer</span><br><span class="line">            extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">        private IntWritable result = new IntWritable();</span><br><span class="line"></span><br><span class="line">        public void reduce(Text key, Iterable&lt;IntWritable&gt; values,</span><br><span class="line">                           Context context</span><br><span class="line">        ) throws IOException, InterruptedException &#123;</span><br><span class="line">            int sum = 0;</span><br><span class="line">            for (IntWritable val : values) &#123;</span><br><span class="line">                sum += val.get();</span><br><span class="line">            &#125;</span><br><span class="line">            result.set(sum);</span><br><span class="line">            context.write(key, result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="完整代码如下"><a href="#完整代码如下" class="headerlink" title="完整代码如下"></a>完整代码如下</h3><p>在运行代码之前，我们需要在该项目之下建立一个input文件夹，在input文件夹下建立一个文本文件，存放用来处理的单词。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.hadoop.conf.Configuration;</span><br><span class="line">import org.apache.hadoop.fs.Path;</span><br><span class="line">import org.apache.hadoop.io.IntWritable;</span><br><span class="line">import org.apache.hadoop.io.Text;</span><br><span class="line">import org.apache.hadoop.mapreduce.Job;</span><br><span class="line">import org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line">import org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line">public class WordCount &#123;</span><br><span class="line"></span><br><span class="line">    public static class TokenizerMapper</span><br><span class="line">            extends Mapper&lt;Object, Text, Text, IntWritable&gt; &#123;</span><br><span class="line"></span><br><span class="line">        private final static IntWritable one = new IntWritable(1);</span><br><span class="line">        private Text word = new Text();</span><br><span class="line"></span><br><span class="line">        public void map(Object key, Text value, Context context</span><br><span class="line">        ) throws IOException, InterruptedException &#123;</span><br><span class="line">            StringTokenizer itr = new StringTokenizer(value.toString());</span><br><span class="line">            while (itr.hasMoreTokens()) &#123;</span><br><span class="line">                word.set(itr.nextToken());</span><br><span class="line">                context.write(word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class IntSumReducer</span><br><span class="line">            extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">        private IntWritable result = new IntWritable();</span><br><span class="line"></span><br><span class="line">        public void reduce(Text key, Iterable&lt;IntWritable&gt; values,</span><br><span class="line">                           Context context</span><br><span class="line">        ) throws IOException, InterruptedException &#123;</span><br><span class="line">            int sum = 0;</span><br><span class="line">            for (IntWritable val : values) &#123;</span><br><span class="line">                sum += val.get();</span><br><span class="line">            &#125;</span><br><span class="line">            result.set(sum);</span><br><span class="line">            context.write(key, result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        Configuration conf = new Configuration();</span><br><span class="line">        String[] otherArgs = new String[]&#123;&quot;input/file.txt&quot;, &quot;output&quot;&#125;;   //input/file.txt便是的</span><br><span class="line">        if (otherArgs.length != 2) &#123;</span><br><span class="line">            System.out.println(&quot;参数错误&quot;);</span><br><span class="line">            System.exit(2);</span><br><span class="line">        &#125;</span><br><span class="line">        Job job = Job.getInstance(conf, &quot;word count&quot;);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line">        job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">        job.setCombinerClass(IntSumReducer.class);</span><br><span class="line">        job.setReducerClass(IntSumReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, new Path(otherArgs[0]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, new Path(otherArgs[1]));</span><br><span class="line">        System.exit(job.waitForCompletion(true) ? 0 : 1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p> 毕竟如上的输入数据比较少，大家可以动手查找自然语言处理的语料包添加到input文件中，感受以下大数据的魅力</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mapreduce/">Mapreduce</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2019 #include&lt;deng&gt;
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>